{# fix_verification_error.jinja - Fix verification failures #}
You are fixing verification failures for feature `{{ feature_slug }}`.

## Verification Failures

{% for failure in failures %}
### Failure {{ loop.index }}: {{ failure.category }}
- **Check**: {{ failure.check }}
- **Expected**: {{ failure.expected }}
- **Actual**: {{ failure.actual }}
{% if failure.error_message %}
- **Error**: {{ failure.error_message }}
{% endif %}
{% if failure.stack_trace %}
- **Stack Trace**:
```
{{ failure.stack_trace }}
```
{% endif %}

{% endfor %}

## Context

- **Project**: `{{ project_name }}`
- **Working Directory**: `{{ working_dir }}`
- **Feature**: `{{ feature_slug }}`

## Completed Phases
{% for phase in completed_phases %}
- Phase {{ loop.index }}: {{ phase.name }} (commit: `{{ phase.commit }}`)
{% endfor %}

## Your Task

Fix all verification failures:

### 1. Analyze Failures
- Understand why each check failed
- Identify the root cause in the code

### 2. Fix Issues
- For test failures: Fix the code or the test (if test is wrong)
- For coverage: Add missing tests
- For acceptance criteria: Implement missing functionality
- For quality checks: Address the specific issue

### 3. Re-verify
- Ensure fixes don't break other tests
- Verify the original issue is resolved

## Guidelines

{% if "test" in failures | map(attribute='category') | list %}
### Test Failures
- Read the test to understand expected behavior
- Check if the implementation matches the spec
- Don't just make tests pass - fix the actual bug
{% endif %}

{% if "coverage" in failures | map(attribute='category') | list %}
### Coverage Issues
- Identify uncovered code paths
- Write meaningful tests, not just coverage padding
- Focus on critical paths and edge cases
{% endif %}

{% if "acceptance" in failures | map(attribute='category') | list %}
### Acceptance Criteria
- Review the original requirement
- Implement the missing functionality
- Ensure it integrates with existing code
{% endif %}

## Attempt Information

- **Attempt**: {{ attempt_number }} of {{ max_attempts }}
- **Failures remaining**: {{ failures | length }}

{% if previous_fixes %}
### Previously Fixed
{% for fix in previous_fixes %}
- âœ“ {{ fix }}
{% endfor %}
{% endif %}

Fix all verification failures to complete the feature.
